<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Recent Chats ‚Äì Admin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-900">
  <div class="max-w-5xl mx-auto px-4 py-6">
    <h1 class="text-2xl font-bold mb-4">üí¨ Recent Chats</h1>
    <a href="/admin/dashboard" class="text-sm text-blue-600 hover:underline">‚Üê Back to Admin Dashboard</a>

    {% if sessions %}
      <div class="mt-4 bg-white rounded-lg shadow overflow-hidden">
        <table class="min-w-full text-sm">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-4 py-2 text-left">Session ID</th>
              <th class="px-4 py-2 text-left">Property</th>
              <th class="px-4 py-2 text-left">Guest</th>
              <th class="px-4 py-2 text-left">Source</th>
              <th class="px-4 py-2 text-left">Verified</th>
              <th class="px-4 py-2 text-left">Priority</th>
              <th class="px-4 py-2 text-left">Last Activity</th>
              <th class="px-4 py-2 text-left">Snippet</th>
              <th class="px-4 py-2 text-left"></th>
            </tr>
          </thead>
          <tbody>
            {% for s in sessions %}
              <tr class="border-t hover:bg-gray-50">
                <td class="px-4 py-2 font-mono text-xs">#{{ s.id }}</td>
                <td class="px-4 py-2">
                  <div class="font-medium">{{ s.property_name }}</div>
                  <div class="text-xs text-gray-500">Property ID: {{ s.property_id }}</div>
                </td>
                <td class="px-4 py-2">
                  <div class="font-medium">{{ s.guest_name or "‚Äî" }}</div></td>
                <td class="px-4 py-2 text-xs text-gray-700">{{ s.source }}</td>
                <td class="px-4 py-2 text-xs">
                  {% if s.is_verified %}
                    <span class="text-green-600 font-semibold">Yes</span>
                  {% else %}
                    <span class="text-gray-500">No</span>
                  {% endif %}
                </td>
                <td class="px-4 py-2 text-xs">
                  {% if s.has_urgent %}
                    <span class="inline-block px-2 py-1 rounded-full bg-red-100 text-red-700 font-semibold mr-1">
                      üî• Urgent
                    </span>
                  {% endif %}
                  {% if s.has_negative %}
                    <span class="inline-block px-2 py-1 rounded-full bg-yellow-100 text-yellow-700 font-semibold">
                      üòü Unhappy
                    </span>
                  {% endif %}
                  {% if not s.has_urgent and not s.has_negative %}
                    <span class="text-gray-400">Normal</span>
                  {% endif %}
                </td>
                <td class="px-4 py-2 text-xs text-gray-700">
                  {{ s.last_activity_at or "‚Äî" }}
                </td>
                <td class="px-4 py-2 text-xs text-gray-600">
                  {{ s.last_snippet }}
                </td>
                <td class="px-4 py-2 text-right">
                  <a href="/admin/chats/{{ s.id }}" class="text-blue-600 hover:underline text-xs">
                    View ‚Üí
                  </a>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <p class="mt-4 text-gray-600">No chat sessions yet.</p>
    {% endif %}
  </div>
</body>
</html>
